import{d as z,i as u,j as I,c as r,a as e,b as n,u as d,s as b,t as a,r as P,F as x,I as f,e as g,x as V,v as _,y as $,aJ as S,o as i}from"./index-oOuEsLBu.js";import{u as T}from"./equipment-DEhfSx24.js";import{f as h}from"./format-t1Knertl.js";const A={class:"p-4"},F={class:"flex flex-col md:flex-row md:items-center md:justify-between mb-6"},G={class:"flex gap-2"},J={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8"},H={class:"surface-card rounded-lg shadow p-4 border-l-4 border-blue-500"},K={class:"flex justify-between items-start"},O={class:"text-2xl font-bold text-color mt-1"},Q={class:"bg-blue-100 p-2 rounded-full text-blue-600"},U={class:"surface-card rounded-lg shadow p-4 border-l-4 border-green-500"},W={class:"flex justify-between items-start"},X={class:"text-2xl font-bold text-color mt-1"},Y={class:"bg-green-100 p-2 rounded-full text-green-600"},Z={class:"surface-card rounded-lg shadow p-4 border-l-4 border-orange-500"},ee={class:"flex justify-between items-start"},te={class:"text-2xl font-bold text-color mt-1"},se={class:"bg-orange-100 p-2 rounded-full text-orange-600"},oe={class:"surface-card rounded-lg shadow p-4 border-l-4 border-red-500"},ne={class:"flex justify-between items-start"},re={class:"text-2xl font-bold text-color mt-1"},ie={class:"bg-red-100 p-2 rounded-full text-red-600"},le={key:0,class:"flex justify-center py-12"},ce={key:1,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-8"},ae=["onClick"],de={class:"flex items-center gap-4"},ue={class:"font-semibold text-color"},pe={class:"text-sm text-color-secondary"},me={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},xe={class:"surface-card rounded-lg shadow p-4"},fe={class:"font-semibold text-color mb-4 flex items-center gap-2"},be={key:0,class:"text-center py-8 text-color-secondary"},ge={key:1,class:"space-y-3"},_e={class:"flex items-center gap-3"},he={class:"font-medium text-color"},ve={class:"text-xs text-red-600"},ye={class:"surface-card rounded-lg shadow p-4"},we={class:"font-semibold text-color mb-4 flex items-center gap-2"},ke={key:0,class:"text-center py-8 text-color-secondary"},qe={key:1,class:"space-y-3"},Ce={class:"flex items-center gap-3"},Ee={class:"font-medium text-color"},je={class:"text-xs text-color-secondary"},Ne=z({__name:"EquipmentDashboard",setup(Le){const p=$(),l=T(),v=u(()=>l.equipmentList.filter(s=>s.status==="available").length),y=u(()=>l.equipmentList.filter(s=>s.status==="maintenance").length),m=u(()=>{const s=new Date;return l.equipmentList.filter(t=>t.expiration_date?new Date(t.expiration_date)<=s:!1)}),w=u(()=>m.value.length),k=s=>h(new Date(s),"dd MMM yyyy",{locale:S}),q=s=>{if(!s.expiration_date)return"";const t=new Date(s.expiration_date);return`Expiré le ${h(t,"dd/MM/yyyy")}`},C=s=>{switch(s){case"periodic_check":return"bg-blue-500";case"repair":return"bg-orange-500";case"calibration":return"bg-purple-500";default:return"bg-gray-500"}},E=s=>{switch(s){case"periodic_check":return"clipboard-check";case"repair":return"tools";case"calibration":return"balance-scale";default:return"file"}},j=s=>{switch(s){case"compliant":return"bg-green-100 text-green-700";case"non_compliant":return"bg-red-100 text-red-700";case"fixed":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},L=s=>{switch(s){case"compliant":return"Conforme";case"non_compliant":return"Non Conforme";case"fixed":return"Réparé";default:return s}},D=s=>{p.push({path:"/equipment/inventory",query:{category:s}})},M=()=>{p.push("/equipment/inventory")},B=()=>{},N=s=>{p.push(`/equipment/${s.id}`)};return I(async()=>{await Promise.all([l.fetchCategories(),l.fetchEquipment(),l.fetchMaintenanceLogs()])}),(s,t)=>{const c=P("font-awesome-icon");return i(),r("div",A,[e("div",F,[t[0]||(t[0]=e("h1",{class:"text-2xl font-bold text-color mb-4 md:mb-0"},"Gestion des Équipements & EPI",-1)),e("div",G,[n(d(b),{label:"Nouvel équipement",icon:"pi pi-plus",onClick:M})])]),e("div",J,[e("div",H,[e("div",K,[e("div",null,[t[1]||(t[1]=e("p",{class:"text-color-secondary text-sm font-medium"},"Total Équipements",-1)),e("h3",O,a(d(l).equipmentList.length),1)]),e("div",Q,[n(c,{icon:"tools"})])])]),e("div",U,[e("div",W,[e("div",null,[t[2]||(t[2]=e("p",{class:"text-color-secondary text-sm font-medium"},"Disponibles",-1)),e("h3",X,a(v.value),1)]),e("div",Y,[n(c,{icon:"check-circle"})])])]),e("div",Z,[e("div",ee,[e("div",null,[t[3]||(t[3]=e("p",{class:"text-color-secondary text-sm font-medium"},"En Maintenance",-1)),e("h3",te,a(y.value),1)]),e("div",se,[n(c,{icon:"wrench"})])])]),e("div",oe,[e("div",ne,[e("div",null,[t[4]||(t[4]=e("p",{class:"text-color-secondary text-sm font-medium"},"EPI Expirés / À contrôler",-1)),e("h3",re,a(w.value),1)]),e("div",ie,[n(c,{icon:"exclamation-triangle"})])])])]),t[10]||(t[10]=e("h2",{class:"text-xl font-semibold text-color mb-4"},"Parcourir par catégorie",-1)),d(l).loading&&!d(l).categories.length?(i(),r("div",le,[n(c,{icon:["fas","spinner"],spin:"",size:"2x",class:"text-color-secondary"})])):(i(),r("div",ce,[(i(!0),r(x,null,f(d(l).categories,o=>(i(),r("div",{key:o.id,class:"surface-card rounded-lg shadow hover:shadow-md transition-shadow cursor-pointer p-4 border border-surface-border",onClick:R=>D(o.id)},[e("div",de,[e("div",{class:"w-12 h-12 rounded-lg flex items-center justify-center text-white text-xl",style:V({backgroundColor:o.color||"#64748B"})},[n(c,{icon:o.icon||"box"},null,8,["icon"])],4),e("div",null,[e("h3",ue,a(o.name),1),e("p",pe,a(o.equipment_count||0)+" éléments",1)])])],8,ae))),128)),e("div",{class:"border-2 border-dashed border-surface-border rounded-lg flex flex-col items-center justify-center p-4 cursor-pointer hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900 transition-colors min-h-[80px]",onClick:B},[n(c,{icon:"plus",class:"text-color-secondary text-xl mb-2"}),t[5]||(t[5]=e("span",{class:"text-color-secondary font-medium text-sm"},"Nouvelle catégorie",-1))])])),e("div",me,[e("div",xe,[e("h3",fe,[n(c,{icon:"bell",class:"text-red-500"}),t[6]||(t[6]=g(" Alertes & Rappels ",-1))]),m.value.length===0?(i(),r("div",be,[n(c,{icon:"check-circle",class:"text-green-500 text-3xl mb-2"}),t[7]||(t[7]=e("p",null,"Tout est en ordre !",-1))])):(i(),r("div",ge,[(i(!0),r(x,null,f(m.value.slice(0,5),o=>(i(),r("div",{key:o.id,class:"flex items-center justify-between p-3 bg-red-50 rounded border border-red-100"},[e("div",_e,[n(c,{icon:"exclamation-circle",class:"text-red-500"}),e("div",null,[e("p",he,a(o.name),1),e("p",ve,a(q(o)),1)])]),n(d(b),{label:"Voir",size:"small",severity:"danger",text:"",onClick:R=>N(o)},null,8,["onClick"])]))),128))]))]),e("div",ye,[e("h3",we,[n(c,{icon:"history",class:"text-blue-500"}),t[8]||(t[8]=g(" Dernières interventions ",-1))]),d(l).maintenanceLogs.length===0?(i(),r("div",ke,[...t[9]||(t[9]=[e("p",null,"Aucun historique récent",-1)])])):(i(),r("div",qe,[(i(!0),r(x,null,f(d(l).maintenanceLogs.slice(0,5),o=>(i(),r("div",{key:o.id,class:"flex items-center justify-between p-3 bg-surface-50 dark:bg-surface-800 rounded border border-surface-border"},[e("div",Ce,[e("div",{class:_(["w-8 h-8 rounded-full flex items-center justify-center text-white text-xs",C(o.type)])},[n(c,{icon:E(o.type)},null,8,["icon"])],2),e("div",null,[e("p",Ee,a(o.equipment?.name||"Équipement inconnu"),1),e("p",je,a(k(o.date))+" - "+a(o.performer),1)])]),e("span",{class:_(["text-xs px-2 py-1 rounded font-medium",j(o.result)])},a(L(o.result)),3)]))),128))]))])])])}}});export{Ne as default};
