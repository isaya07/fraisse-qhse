import{D as h,E as o,ap as c}from"./index-oOuEsLBu.js";const d=h("user",{state:()=>({users:[],currentUser:null,loading:!1,error:null,pagination:{page:1,limit:15,total:0,totalPages:1}}),getters:{userById:s=>r=>s.users.find(e=>e.id===r)},actions:{async fetchUsers(s=1,r=15,e={}){this.loading=!0,this.error=null;try{const{get:a}=o(),i=new URLSearchParams({page:s.toString(),limit:r.toString()});Object.entries(e).forEach(([l,n])=>{n!=null&&n!==""&&i.append(l,String(n))});const t=await a(`/users?${i.toString()}`);t.success&&t.data?c(t.data)?(this.users=t.data.data||[],this.pagination={...this.pagination,page:t.data.current_page||s,limit:t.data.per_page||r,total:t.data.total||this.users.length,totalPages:t.data.last_page||1}):(this.users=Array.isArray(t.data)?t.data:[t.data],this.pagination={...this.pagination,page:s,limit:r,total:this.users.length,totalPages:Math.ceil(this.users.length/r)}):this.error=t.error||"Failed to fetch users"}catch(a){this.error="An error occurred while fetching users",console.error(a)}finally{this.loading=!1}},async fetchUserById(s){this.loading=!0,this.error=null;try{const{get:r}=o(),e=await r(`/users/${s}`);e.success&&e.data?this.currentUser=e.data:this.error=e.error||"Failed to fetch user"}catch(r){this.error="An error occurred while fetching user",console.error(r)}finally{this.loading=!1}},async createUser(s){this.loading=!0,this.error=null;try{const{post:r}=o(),e=await r("/users",s);if(e.success&&e.data)this.users.unshift(e.data),this.currentUser=e.data;else throw this.error=e.error||"Failed to create user",new Error(this.error)}catch(r){throw this.error="An error occurred while creating user",console.error(r),r}finally{this.loading=!1}},async updateUser(s,r){this.loading=!0,this.error=null;try{const{put:e}=o(),a=await e(`/users/${s}`,r);if(a.success&&a.data){const i=this.users.findIndex(t=>t.id===s);i!==-1&&(this.users[i]=a.data),this.currentUser=a.data}else throw this.error=a.error||"Failed to update user",new Error(this.error)}catch(e){throw this.error="An error occurred while updating user",console.error(e),e}finally{this.loading=!1}},async deleteUser(s){this.loading=!0,this.error=null;try{const{del:r}=o(),e=await r(`/users/${s}`);if(e.success)this.users=this.users.filter(a=>a.id!==s),this.currentUser?.id===s&&(this.currentUser=null);else throw this.error=e.error||"Failed to delete user",new Error(this.error)}catch(r){throw this.error="An error occurred while deleting user",console.error(r),r}finally{this.loading=!1}}}});export{d as u};
