import{u as E}from"./equipment-DEhfSx24.js";import{s as u}from"./index-IzGGsCUm.js";import{s as _}from"./index-CFLhIysZ.js";import{s as y}from"./index-CYWC0yQY.js";import{d as C,g as S,h as x,j as D,c as d,a,b as i,p as v,u as n,v as r,t as f,s as V,o as m}from"./index-oOuEsLBu.js";import{s as $}from"./index-D4NNOuL2.js";import{f as g}from"./format-t1Knertl.js";const B={class:"equipment-form"},N={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},j={class:"field"},F={key:0,class:"text-red-500"},A={class:"field"},O={key:0,class:"text-red-500"},R={class:"field"},z={key:0,class:"text-red-500"},H={class:"field"},I={class:"field"},T={class:"field"},G={class:"field"},J={key:0,class:"text-red-500"},K={class:"field"},P={class:"field"},Q={class:"field"},W={class:"field"},X={class:"field col-span-1 md:col-span-2"},Y={class:"flex justify-end gap-2 mt-6"},ne=C({__name:"EquipmentForm",props:{equipment:{}},emits:["save","cancel"],setup(q,{emit:k}){const o=q,w=k,c=E(),b=S(),l=x({name:"",category_id:null,serial_number:"",internal_ref:"",brand:"",model:"",purchase_date:null,expiration_date:null,maintenance_frequency_months:null,status:"available",location:"warehouse",image_path:""}),s=x({}),h=[{label:"Disponible",value:"available"},{label:"Affecté",value:"assigned"},{label:"En Maintenance",value:"maintenance"},{label:"Hors Service",value:"broken"},{label:"Rebuté",value:"retired"}],U=[{label:"Magasin",value:"warehouse"},{label:"Atelier",value:"workshop"},{label:"Bureau",value:"office"},{label:"Véhicule",value:"vehicle"},{label:"Chantier",value:"site"}];D(()=>{o.equipment&&(l.value={name:o.equipment.name,category_id:o.equipment.category_id,serial_number:o.equipment.serial_number,internal_ref:o.equipment.internal_ref,brand:o.equipment.brand,model:o.equipment.model,purchase_date:o.equipment.purchase_date?new Date(o.equipment.purchase_date):null,expiration_date:o.equipment.expiration_date?new Date(o.equipment.expiration_date):null,maintenance_frequency_months:o.equipment.maintenance_frequency_months,status:o.equipment.status,location:o.equipment.location,image_path:o.equipment.image_path})});const L=()=>(s.value={},l.value.name||(s.value.name="Le nom est requis"),l.value.category_id||(s.value.category_id="La catégorie est requise"),l.value.serial_number||(s.value.serial_number="Le numéro de série est requis"),l.value.purchase_date||(s.value.purchase_date="La date d'achat est requise"),l.value.status||(s.value.status="Le statut est requis"),l.value.location||(s.value.location="La localisation est requise"),Object.keys(s.value).length===0),M=async()=>{if(!L())return;const p={...l.value,category_id:l.value.category_id||void 0,status:l.value.status,location:l.value.location,purchase_date:l.value.purchase_date?g(l.value.purchase_date,"yyyy-MM-dd"):void 0,expiration_date:l.value.expiration_date?g(l.value.expiration_date,"yyyy-MM-dd"):null};try{o.equipment?(await c.updateEquipment(o.equipment.id,p),b.add({severity:"success",summary:"Succès",detail:"Équipement mis à jour",life:3e3})):(await c.createEquipment(p),b.add({severity:"success",summary:"Succès",detail:"Équipement créé",life:3e3})),w("save")}catch(e){console.error(e),b.add({severity:"error",summary:"Erreur",detail:"Une erreur est survenue lors de l'enregistrement",life:3e3})}};return(p,e)=>(m(),d("div",B,[a("div",N,[a("div",j,[e[13]||(e[13]=a("label",{for:"name",class:"block text-sm font-medium text-color-secondary mb-1"},"Nom de l'équipement *",-1)),i(n(u),{id:"name",modelValue:l.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.name=t),class:r(["w-full",{"p-invalid":s.value.name}])},null,8,["modelValue","class"]),s.value.name?(m(),d("small",F,f(s.value.name),1)):v("",!0)]),a("div",A,[e[14]||(e[14]=a("label",{for:"category",class:"block text-sm font-medium text-color-secondary mb-1"},"Catégorie *",-1)),i(n(_),{id:"category",modelValue:l.value.category_id,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.category_id=t),options:n(c).categories,optionLabel:"name",optionValue:"id",placeholder:"Sélectionner une catégorie",class:r(["w-full",{"p-invalid":s.value.category_id}])},null,8,["modelValue","options","class"]),s.value.category_id?(m(),d("small",O,f(s.value.category_id),1)):v("",!0)]),a("div",R,[e[15]||(e[15]=a("label",{for:"serial_number",class:"block text-sm font-medium text-color-secondary mb-1"},"Numéro de série *",-1)),i(n(u),{id:"serial_number",modelValue:l.value.serial_number,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.serial_number=t),class:r(["w-full",{"p-invalid":s.value.serial_number}])},null,8,["modelValue","class"]),s.value.serial_number?(m(),d("small",z,f(s.value.serial_number),1)):v("",!0)]),a("div",H,[e[16]||(e[16]=a("label",{for:"internal_ref",class:"block text-sm font-medium text-color-secondary mb-1"},"Référence interne",-1)),i(n(u),{id:"internal_ref",modelValue:l.value.internal_ref,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.internal_ref=t),class:"w-full"},null,8,["modelValue"])]),a("div",I,[e[17]||(e[17]=a("label",{for:"brand",class:"block text-sm font-medium text-color-secondary mb-1"},"Marque",-1)),i(n(u),{id:"brand",modelValue:l.value.brand,"onUpdate:modelValue":e[4]||(e[4]=t=>l.value.brand=t),class:"w-full"},null,8,["modelValue"])]),a("div",T,[e[18]||(e[18]=a("label",{for:"model",class:"block text-sm font-medium text-color-secondary mb-1"},"Modèle",-1)),i(n(u),{id:"model",modelValue:l.value.model,"onUpdate:modelValue":e[5]||(e[5]=t=>l.value.model=t),class:"w-full"},null,8,["modelValue"])]),a("div",G,[e[19]||(e[19]=a("label",{for:"purchase_date",class:"block text-sm font-medium text-color-secondary mb-1"},"Date d'achat *",-1)),i(n(y),{id:"purchase_date",modelValue:l.value.purchase_date,"onUpdate:modelValue":e[6]||(e[6]=t=>l.value.purchase_date=t),dateFormat:"dd/mm/yy",class:r(["w-full",{"p-invalid":s.value.purchase_date}])},null,8,["modelValue","class"]),s.value.purchase_date?(m(),d("small",J,f(s.value.purchase_date),1)):v("",!0)]),a("div",K,[e[20]||(e[20]=a("label",{for:"expiration_date",class:"block text-sm font-medium text-color-secondary mb-1"},"Date d'expiration",-1)),i(n(y),{id:"expiration_date",modelValue:l.value.expiration_date,"onUpdate:modelValue":e[7]||(e[7]=t=>l.value.expiration_date=t),dateFormat:"dd/mm/yy",class:"w-full"},null,8,["modelValue"])]),a("div",P,[e[21]||(e[21]=a("label",{for:"maintenance_frequency_months",class:"block text-sm font-medium text-color-secondary mb-1"},"Fréquence de contrôle (mois)",-1)),i(n($),{id:"maintenance_frequency_months",modelValue:l.value.maintenance_frequency_months,"onUpdate:modelValue":e[8]||(e[8]=t=>l.value.maintenance_frequency_months=t),class:"w-full",min:0,showButtons:""},null,8,["modelValue"])]),a("div",Q,[e[22]||(e[22]=a("label",{for:"status",class:"block text-sm font-medium text-color-secondary mb-1"},"Statut *",-1)),i(n(_),{id:"status",modelValue:l.value.status,"onUpdate:modelValue":e[9]||(e[9]=t=>l.value.status=t),options:h,optionLabel:"label",optionValue:"value",class:r(["w-full",{"p-invalid":s.value.status}])},null,8,["modelValue","class"])]),a("div",W,[e[23]||(e[23]=a("label",{for:"location",class:"block text-sm font-medium text-color-secondary mb-1"},"Localisation *",-1)),i(n(_),{id:"location",modelValue:l.value.location,"onUpdate:modelValue":e[10]||(e[10]=t=>l.value.location=t),options:U,optionLabel:"label",optionValue:"value",class:r(["w-full",{"p-invalid":s.value.location}])},null,8,["modelValue","class"])]),a("div",X,[e[24]||(e[24]=a("label",{for:"image_path",class:"block text-sm font-medium text-color-secondary mb-1"},"URL Image",-1)),i(n(u),{id:"image_path",modelValue:l.value.image_path,"onUpdate:modelValue":e[11]||(e[11]=t=>l.value.image_path=t),class:"w-full",placeholder:"https://..."},null,8,["modelValue"])])]),a("div",Y,[i(n(V),{label:"Annuler",icon:"pi pi-times",severity:"secondary",text:"",onClick:e[12]||(e[12]=t=>p.$emit("cancel"))}),i(n(V),{label:"Enregistrer",icon:"pi pi-check",onClick:M,loading:n(c).loading},null,8,["loading"])])]))}});export{ne as _};
