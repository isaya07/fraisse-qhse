import{d as M,f as A,h as _,j as T,c as m,a as p,b as e,w as s,s as j,u as v,k as z,aQ as E,r as L,e as g,t as c,o as f}from"./index-oOuEsLBu.js";import{s as P,a as R}from"./index-obDBiGqA.js";import{s as q}from"./index-B3ik4ugR.js";import{u as Q}from"./planning-Ce_9FduL.js";import{_ as U}from"./VisitForm.vue_vue_type_script_setup_true_lang-CD5yS_7I.js";import{f as F}from"./format-t1Knertl.js";import"./index-DXuF__Dl.js";import"./index-CFLhIysZ.js";import"./index-B0RCps1L.js";import"./index-kYhIjE44.js";import"./index-IzGGsCUm.js";import"./index-D4NNOuL2.js";import"./index-D2qS9a38.js";import"./index-C1JXx-aU.js";import"./index-Bsb9bHmP.js";import"./index-CYWC0yQY.js";import"./users-CY6PsBvV.js";const G={class:"card"},H={class:"flex justify-between items-center mb-4"},I={key:0},J={key:1},K={class:"flex gap-2"},pe=M({__name:"SafetyVisits",setup(O){const r=Q(),y=A(),i=_(!1),l=_(void 0);T(()=>{r.fetchVisits()});const b=o=>F(new Date(o),"dd/MM/yyyy"),h=o=>{switch(o){case"planned":return"Planifiée";case"completed":return"Réalisée";case"cancelled":return"Annulée";default:return o}},x=o=>{switch(o){case"planned":return"info";case"completed":return"success";case"cancelled":return"danger";default:return"secondary"}},C=()=>{l.value=void 0,i.value=!0},w=o=>{l.value=o,i.value=!0},D=()=>{i.value=!1,r.fetchVisits()},V=o=>{y.require({message:"Êtes-vous sûr de vouloir supprimer cette visite ?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{r.deleteVisit(o.id)}})};return(o,a)=>{const d=L("font-awesome-icon"),u=j,n=R,k=q,S=P,$=z,N=E;return f(),m("div",G,[p("div",H,[a[2]||(a[2]=p("h1",{class:"text-2xl font-bold text-gray-800"},"Visites Sécurité",-1)),e(u,{label:"Nouvelle Visite",onClick:C},{icon:s(()=>[e(d,{icon:"plus"})]),_:1})]),e(S,{value:v(r).visits,loading:v(r).loading,paginator:"",rows:10,stripedRows:""},{default:s(()=>[e(n,{field:"date",header:"Date",sortable:""},{body:s(({data:t})=>[g(c(b(t.date)),1)]),_:1}),e(n,{field:"location",header:"Lieu",sortable:""}),e(n,{field:"auditor.first_name",header:"Auditeur",sortable:""},{body:s(({data:t})=>[g(c(t.auditor.first_name)+" "+c(t.auditor.last_name),1)]),_:1}),e(n,{field:"status",header:"Statut",sortable:""},{body:s(({data:t})=>[e(k,{value:h(t.status),severity:x(t.status)},null,8,["value","severity"])]),_:1}),e(n,{field:"score",header:"Score",sortable:""},{body:s(({data:t})=>[t.score!==null?(f(),m("span",I,c(t.score)+"/100",1)):(f(),m("span",J,"-"))]),_:1}),e(n,{header:"Actions",style:{width:"120px"}},{body:s(({data:t})=>[p("div",K,[e(u,{size:"small",text:"",rounded:"",severity:"info",onClick:B=>w(t)},{icon:s(()=>[e(d,{icon:"pencil"})]),_:1},8,["onClick"]),e(u,{size:"small",text:"",rounded:"",severity:"danger",onClick:B=>V(t)},{icon:s(()=>[e(d,{icon:"trash"})]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["value","loading"]),e($,{visible:i.value,"onUpdate:visible":a[1]||(a[1]=t=>i.value=t),header:l.value?"Modifier la visite":"Nouvelle visite",modal:"",class:"p-fluid w-full max-w-lg"},{default:s(()=>[e(U,{visit:l.value,onSave:D,onCancel:a[0]||(a[0]=t=>i.value=!1)},null,8,["visit"])]),_:1},8,["visible","header"]),e(N)])}}});export{pe as default};
