import{T as C}from"./index-CrhbiAe9.js";import{d as z,i as x,j as E,c as f,a as t,b as s,w as i,r as v,u as c,m as g,F,I as M,s as b,t as d,e as N,l as V,v as h,y as B,o as m}from"./index-d7axL_xv.js";import{u as R}from"./training-as_QKjE7.js";import{s as p}from"./index-DK5WICtn.js";import{_ as P}from"./SessionList.vue_vue_type_script_setup_true_lang-BA5RpajE.js";import"./index-C0aPiIhq.js";import"./index-C45h_JBJ.js";import"./index-C4Jjik4c.js";import"./index-xoP2DrFw.js";import"./index-D_33rlMc.js";import"./index-DZQqA5uS.js";import"./index-DbX5rEQv.js";import"./index-rhSU9nKe.js";import"./index-BixvgfbH.js";import"./index-Cx-_v3H7.js";import"./index-Dw7kVe-F.js";const $={class:"p-4"},L={class:"flex flex-col md:flex-row md:items-center md:justify-between mb-6"},A={class:"flex gap-2"},I={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},q={class:"flex items-center justify-between"},G={class:"text-3xl font-bold text-color"},H={class:"w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center text-blue-600 dark:text-blue-400"},J={class:"flex items-center justify-between"},K={class:"text-3xl font-bold text-color"},O={class:"w-12 h-12 rounded-full bg-green-100 dark:bg-green-900/20 flex items-center justify-center text-green-600 dark:text-green-400"},Q={class:"flex items-center justify-between"},U={class:"text-3xl font-bold text-color"},W={class:"w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900/20 flex items-center justify-center text-purple-600 dark:text-purple-400"},X={class:"flex items-center justify-between"},Y={class:"text-3xl font-bold text-color"},Z={class:"w-12 h-12 rounded-full bg-orange-100 dark:bg-orange-900/20 flex items-center justify-center text-orange-600 dark:text-orange-400"},tt={class:"mb-8"},et={class:"flex items-center justify-between mb-4"},st={class:"mb-8"},ot={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},nt={class:"flex items-start justify-between"},it={class:"block font-semibold text-color"},rt={class:"block text-sm text-color-secondary mt-1"},lt={class:"mt-2 flex items-center gap-2 text-sm"},jt=z({__name:"TrainingDashboard",setup(at){const y=B(),u=R(),k=x(()=>u.sessions.filter(o=>o.status==="planned").length),w=x(()=>u.trainings.length),T=x(()=>0),j=x(()=>u.sessions.filter(o=>o.status==="planned").sort((o,e)=>new Date(o.start_date).getTime()-new Date(e.start_date).getTime()).slice(0,5)),_=x(()=>{const o=[],e=new Date,n=new Date;return n.setMonth(e.getMonth()+3),u.sessions.forEach(a=>{a.participations&&a.participations.forEach(l=>{if(l.status==="validated"&&l.expiration_date){const r=new Date(l.expiration_date);r<=n&&o.push({id:l.id,user:l.user,training:a.training,expiration_date:l.expiration_date,is_expired:r<e})}})}),o.sort((a,l)=>new Date(a.expiration_date).getTime()-new Date(l.expiration_date).getTime())}),D=o=>{y.push(`/trainings/sessions/${o.id}`)},S=o=>{console.log("Edit session",o.id)};return E(async()=>{await Promise.all([u.fetchSessions(),u.fetchTrainings()])}),(o,e)=>{const n=v("font-awesome-icon"),a=v("router-link"),l=C;return m(),f("div",$,[t("div",L,[e[0]||(e[0]=t("h2",null,"Tableau de bord Formation",-1)),t("div",A,[s(a,{to:"/trainings/catalog"},{default:i(()=>[s(c(b),{label:"Catalogue",severity:"secondary",outlined:""},{icon:i(()=>[s(n,{icon:"book",class:"mr-2"})]),_:1})]),_:1}),s(a,{to:"/trainings/sessions"},{default:i(()=>[s(c(b),{label:"Sessions",severity:"secondary",outlined:""},{icon:i(()=>[s(n,{icon:"calendar",class:"mr-2"})]),_:1})]),_:1})])]),t("div",I,[s(c(p),null,{content:i(()=>[t("div",q,[t("div",null,[e[1]||(e[1]=t("span",{class:"block text-color-secondary text-sm font-medium mb-1"},"Sessions à venir",-1)),t("span",G,d(k.value),1)]),t("div",H,[s(n,{icon:"calendar-alt",size:"lg"})])])]),_:1}),s(c(p),null,{content:i(()=>[t("div",J,[t("div",null,[e[2]||(e[2]=t("span",{class:"block text-color-secondary text-sm font-medium mb-1"},"Formations actives",-1)),t("span",K,d(w.value),1)]),t("div",O,[s(n,{icon:"book-open",size:"lg"})])])]),_:1}),s(c(p),null,{content:i(()=>[t("div",Q,[t("div",null,[e[3]||(e[3]=t("span",{class:"block text-color-secondary text-sm font-medium mb-1"},"Participants ce mois",-1)),t("span",U,d(T.value),1)]),t("div",W,[s(n,{icon:"users",size:"lg"})])])]),_:1}),s(c(p),null,{content:i(()=>[t("div",X,[t("div",null,[e[4]||(e[4]=t("span",{class:"block text-color-secondary text-sm font-medium mb-1"},"Renouvellements",-1)),t("span",Y,d(_.value.length),1)]),t("div",Z,[s(n,{icon:"clock",size:"lg"})])])]),_:1})]),t("div",tt,[t("div",et,[e[6]||(e[6]=t("h3",null,"Prochaines sessions",-1)),s(a,{to:"/trainings/sessions",class:"text-blue-600 hover:text-blue-800 text-sm font-medium"},{default:i(()=>[...e[5]||(e[5]=[N(" Voir tout ",-1)])]),_:1})]),s(P,{sessions:j.value,onView:D,onEdit:S},null,8,["sessions"])]),t("div",st,[e[9]||(e[9]=t("h3",null,"Renouvellements à prévoir",-1)),_.value.length>0?(m(),f("div",ot,[(m(!0),f(F,null,M(_.value,r=>(m(),g(c(p),{key:r.id},{content:i(()=>[t("div",nt,[t("div",null,[t("span",it,d(r.training?.title),1),t("span",rt,d(r.user?.first_name)+" "+d(r.user?.last_name),1),t("div",lt,[s(n,{icon:"clock",class:h(r.is_expired?"text-red-600":"text-orange-600")},null,8,["class"]),t("span",{class:h(r.is_expired?"text-red-700 font-medium":"text-orange-700")}," Expire le "+d(new Date(r.expiration_date).toLocaleDateString()),3)])]),V((m(),g(c(b),{text:"",rounded:"",size:"small",severity:r.is_expired?"danger":"warning"},{icon:i(()=>[s(n,{icon:"envelope"})]),_:1},8,["severity"])),[[l,"Relancer"]])])]),_:2},1024))),128))])):(m(),g(c(p),{key:1},{content:i(()=>[s(n,{icon:"check-circle",class:"text-green-500 text-3xl mb-3"}),e[7]||(e[7]=t("p",{class:"text-color font-medium"}," Aucun renouvellement à prévoir pour les 3 prochains mois. ",-1)),e[8]||(e[8]=t("p",{class:"text-color-secondary text-sm mt-1"},"Tout est à jour !",-1))]),_:1}))])])}}});export{jt as default};
