import{s as w}from"./index-CO5Pw-j-.js";import{d as B,g as j,h as n,j as E,i as C,c as s,a as c,m as D,b as l,w as y,s as N,r as S,t as q,H as z,y as M,o as a}from"./index-oOuEsLBu.js";import{u as R}from"./indicators-DW2GygZt.js";import{_ as T}from"./IndicatorForm.vue_vue_type_script_setup_true_lang-CFAmozmi.js";import"./index-IzGGsCUm.js";import"./index-D4NNOuL2.js";import"./index-CFLhIysZ.js";import"./index-B0RCps1L.js";import"./index-kYhIjE44.js";import"./index-D25kfrV8.js";import"./index-C1JXx-aU.js";import"./indicatorCategories-nHEIoh8X.js";import"./users-CY6PsBvV.js";import"./schemas-C8kxHR-7.js";const V={class:"p-4 p-4"},$={class:"flex flex-col md:flex-row md:items-center md:justify-between mb-6"},H={key:0,class:"flex justify-center items-center py-12"},L={key:1,class:"flex justify-center items-center py-12"},A={key:2,class:"flex justify-center items-center py-12"},F={class:"text-lg text-red-600"},ae=B({__name:"IndicateurEdit",setup(G){const d=M(),p=z(),i=R(),f=j(),v=n({name:"",description:"",code:"",indicator_category_id:null,unit:"",target_value:null,threshold_min:null,threshold_max:null,calculation_method:"",data_source:"",frequency:"monthly",trend_direction:"neutral",goal_type:"maximize",is_active:!0}),u=n(!1),m=n(!1),t=n(""),h=async()=>{const o=parseInt(p.params.id);if(isNaN(o)){t.value="ID d'indicateur invalide";return}u.value=!0,t.value="";try{await i.fetchIndicatorById(o);const e=i.currentIndicator;e?v.value={name:e.name,description:e.description||"",code:e.code,indicator_category_id:e.indicator_category_id||null,unit:e.unit||"",target_value:e.target_value||null,threshold_min:e.threshold_min||null,threshold_max:e.threshold_max||null,calculation_method:e.calculation_method||"",data_source:e.data_source||"",frequency:e.frequency,trend_direction:e.trend_direction,goal_type:e.goal_type||"maximize",is_active:e.is_active}:t.value="Indicateur non trouvé"}catch(e){console.error("Erreur lors du chargement de l'indicateur:",e),t.value="Erreur lors du chargement de l'indicateur"}finally{u.value=!1}},g=async o=>{const e=parseInt(p.params.id);if(isNaN(e)){t.value="ID d'indicateur invalide";return}m.value=!0,t.value="";try{await i.updateIndicator(e,{...o,target_value:o.target_value,threshold_min:o.threshold_min,threshold_max:o.threshold_max}),f.add({severity:"success",summary:"Succès",detail:"Indicateur mis à jour avec succès",life:3e3}),d.push("/indicators/config")}catch(r){const _=r.message||"Erreur lors de la mise à jour de l'indicateur";f.add({severity:"error",summary:"Erreur",detail:_,life:3e3}),console.error(r)}finally{m.value=!1}},x=()=>{d.push("/indicators/config")},I=()=>d.back();E(()=>{h()});const k=C(()=>i.currentIndicator);return(o,e)=>{const r=S("font-awesome-icon"),_=N,b=w;return a(),s("div",V,[c("div",$,[e[0]||(e[0]=c("h2",null,"Modifier l'indicateur",-1)),l(_,{label:"Retour",onClick:I,severity:"secondary",variant:"outlined"},{icon:y(()=>[l(r,{icon:"arrow-left",class:"mr-2"})]),_:1})]),u.value?(a(),s("div",H,[l(r,{icon:["fas","spinner"],spin:"",size:"2x",class:"text-color-secondary"})])):!k.value&&!t.value?(a(),s("div",L,[...e[1]||(e[1]=[c("p",{class:"text-lg text-color-secondary"},"Indicateur non trouvé",-1)])])):t.value?(a(),s("div",A,[c("p",F,q(t.value),1)])):(a(),D(b,{key:3},{content:y(()=>[l(T,{initialData:v.value,submitButtonText:"Enregistrer les modifications",loading:m.value,onSubmit:g,onCancel:x},null,8,["initialData","loading"])]),_:1}))])}}});export{ae as default};
