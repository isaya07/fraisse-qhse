import{D as l,E as o}from"./index-d7axL_xv.js";const p=l("training",{state:()=>({categories:[],organizations:[],trainings:[],sessions:[],loading:!1,error:null}),actions:{async fetchCategories(){this.loading=!0;try{const{get:i}=o(),s=await i("/training-categories");if(s.success&&s.data){const t=s.data;this.categories=Array.isArray(t)?t:t.data}}catch(i){this.error="Failed to fetch categories",console.error(i)}finally{this.loading=!1}},async createCategory(i){this.loading=!0;try{const{post:s}=o(),t=await s("/training-categories",i);if(t.success&&t.data){const a=t.data,n=Array.isArray(a)?a[0]:"data"in a?a.data:a;return this.categories.push(n),n}}catch(s){throw this.error="Failed to create category",s}finally{this.loading=!1}},async updateCategory(i,s){this.loading=!0;try{const{put:t}=o(),a=await t(`/training-categories/${i}`,s);if(a.success&&a.data){const n=a.data,r=Array.isArray(n)?n[0]:"data"in n?n.data:n,e=this.categories.findIndex(c=>c.id===i);return e!==-1&&(this.categories[e]=r),r}}catch(t){throw this.error="Failed to update category",t}finally{this.loading=!1}},async deleteCategory(i){this.loading=!0;try{const{del:s}=o();(await s(`/training-categories/${i}`)).success&&(this.categories=this.categories.filter(a=>a.id!==i))}catch(s){throw this.error="Failed to delete category",s}finally{this.loading=!1}},async fetchOrganizations(){this.loading=!0;try{const{get:i}=o(),s=await i("/training-organizations");if(s.success&&s.data){const t=s.data;this.organizations=Array.isArray(t)?t:t.data}}catch(i){this.error="Failed to fetch organizations",console.error(i)}finally{this.loading=!1}},async createOrganization(i){this.loading=!0;try{const{post:s}=o(),t=await s("/training-organizations",i);if(t.success&&t.data){const a=t.data,n=Array.isArray(a)?a[0]:"data"in a?a.data:a;return this.organizations.push(n),n}}catch(s){throw this.error="Failed to create organization",s}finally{this.loading=!1}},async updateOrganization(i,s){this.loading=!0;try{const{put:t}=o(),a=await t(`/training-organizations/${i}`,s);if(a.success&&a.data){const n=a.data,r=Array.isArray(n)?n[0]:"data"in n?n.data:n,e=this.organizations.findIndex(c=>c.id===i);return e!==-1&&(this.organizations[e]=r),r}}catch(t){throw this.error="Failed to update organization",t}finally{this.loading=!1}},async deleteOrganization(i){this.loading=!0;try{const{del:s}=o();(await s(`/training-organizations/${i}`)).success&&(this.organizations=this.organizations.filter(a=>a.id!==i))}catch(s){throw this.error="Failed to delete organization",s}finally{this.loading=!1}},async fetchTrainings(){this.loading=!0;try{const{get:i}=o(),s=await i("/trainings");if(s.success&&s.data){const t=s.data;this.trainings=Array.isArray(t)?t:t.data}}catch(i){this.error="Failed to fetch trainings",console.error(i)}finally{this.loading=!1}},async createTraining(i){this.loading=!0;try{const{post:s}=o(),t=await s("/trainings",i);if(t.success&&t.data){const a=t.data,n=Array.isArray(a)?a[0]:"data"in a?a.data:a;return this.trainings.push(n),n}}catch(s){throw this.error="Failed to create training",s}finally{this.loading=!1}},async updateTraining(i,s){this.loading=!0;try{const{put:t}=o(),a=await t(`/trainings/${i}`,s);if(a.success&&a.data){const n=a.data,r=Array.isArray(n)?n[0]:"data"in n?n.data:n,e=this.trainings.findIndex(c=>c.id===i);return e!==-1&&(this.trainings[e]=r),r}}catch(t){throw this.error="Failed to update training",t}finally{this.loading=!1}},async deleteTraining(i){this.loading=!0;try{const{del:s}=o();(await s(`/trainings/${i}`)).success&&(this.trainings=this.trainings.filter(a=>a.id!==i))}catch(s){throw this.error="Failed to delete training",s}finally{this.loading=!1}},async fetchSessions(){this.loading=!0;try{const{get:i}=o(),s=await i("/training-sessions");if(s.success&&s.data){const t=s.data;this.sessions=Array.isArray(t)?t:t.data}}catch(i){this.error="Failed to fetch sessions",console.error(i)}finally{this.loading=!1}},async createSession(i){this.loading=!0;try{const{post:s}=o(),t=await s("/training-sessions",i);if(t.success&&t.data){const a=t.data,n=Array.isArray(a)?a[0]:"data"in a?a.data:a;return this.sessions.push(n),n}}catch(s){throw this.error="Failed to create session",s}finally{this.loading=!1}},async updateSession(i,s){this.loading=!0;try{const{put:t}=o(),a=await t(`/training-sessions/${i}`,s);if(a.success&&a.data){const n=a.data,r=Array.isArray(n)?n[0]:"data"in n?n.data:n,e=this.sessions.findIndex(c=>c.id===i);return e!==-1&&(this.sessions[e]=r),r}}catch(t){throw this.error="Failed to update session",t}finally{this.loading=!1}},async deleteSession(i){this.loading=!0;try{const{del:s}=o();(await s(`/training-sessions/${i}`)).success&&(this.sessions=this.sessions.filter(a=>a.id!==i))}catch(s){throw this.error="Failed to delete session",s}finally{this.loading=!1}},async addParticipant(i){this.loading=!0;try{const{post:s}=o(),t=await s("/training-participations",i);if(t.success&&t.data){const a=t.data,n=Array.isArray(a)?a[0]:"data"in a?a.data:a,r=this.sessions.findIndex(e=>e.id===i.training_session_id);return r!==-1&&this.sessions[r]&&(this.sessions[r].participations||(this.sessions[r].participations=[]),this.sessions[r].participations?.push(n)),n}}catch(s){throw this.error="Failed to add participant",s}finally{this.loading=!1}},async updateParticipant(i,s){this.loading=!0;try{const{put:t}=o(),a=await t(`/training-participations/${i}`,s);if(a.success&&a.data){const n=a.data,r=Array.isArray(n)?n[0]:"data"in n?n.data:n,e=this.sessions.findIndex(c=>c.id===r.training_session_id);if(e!==-1&&this.sessions[e]){const c=this.sessions[e].participations;if(c){const d=c.findIndex(h=>h.id===i);d!==-1&&(c[d]=r)}}return r}}catch(t){throw this.error="Failed to update participant",t}finally{this.loading=!1}},async removeParticipant(i,s){this.loading=!0;try{const{del:t}=o();if((await t(`/training-participations/${i}`)).success){const n=this.sessions.findIndex(r=>r.id===s);if(n!==-1&&this.sessions[n]){const r=this.sessions[n].participations;r&&(this.sessions[n].participations=r.filter(e=>e.id!==i))}}}catch(t){throw this.error="Failed to remove participant",t}finally{this.loading=!1}}}});export{p as u};
