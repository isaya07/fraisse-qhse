import{D as d,E as s,ap as l}from"./index-d7axL_xv.js";const u=d("indicator",{state:()=>({indicators:[],currentIndicator:null,loading:!1,error:null,pagination:{page:1,limit:10,total:0,totalPages:1}}),getters:{indicatorById:i=>t=>i.indicators.find(r=>r.id===t)},actions:{async fetchIndicators(i=1,t=10,r={}){this.loading=!0,this.error=null;try{const{get:e}=s(),a=new URLSearchParams({page:i.toString(),limit:t.toString()});Object.entries(r).forEach(([c,n])=>{n!=null&&n!==""&&a.append(c,String(n))});const o=await e(`/indicators?${a.toString()}`);o.success&&o.data?l(o.data)?(this.indicators=o.data.data||[],this.pagination={...this.pagination,page:o.data.current_page||i,limit:o.data.per_page||t,total:o.data.total||this.indicators.length,totalPages:o.data.last_page||1}):(this.indicators=Array.isArray(o.data)?o.data:[o.data],this.pagination={...this.pagination,page:i,limit:t,total:this.indicators.length,totalPages:Math.ceil(this.indicators.length/t)}):this.error=o.error||"Failed to fetch indicators"}catch(e){this.error="An error occurred while fetching indicators",console.error(e)}finally{this.loading=!1}},async fetchIndicatorById(i){this.loading=!0,this.error=null;try{const{get:t}=s(),r=await t(`/indicators/${i}`);r.success&&r.data?this.currentIndicator=r.data:this.error=r.error||"Failed to fetch indicator"}catch(t){this.error="An error occurred while fetching indicator",console.error(t)}finally{this.loading=!1}},async createIndicator(i){this.loading=!0,this.error=null;try{const{post:t}=s(),r=await t("/indicators",i);if(r.success&&r.data)this.indicators.unshift(r.data),this.currentIndicator=r.data;else throw this.error=r.error||"Failed to create indicator",new Error(this.error)}catch(t){throw this.error="An error occurred while creating indicator",console.error(t),t}finally{this.loading=!1}},async updateIndicator(i,t){this.loading=!0,this.error=null;try{const{put:r}=s(),e=await r(`/indicators/${i}`,t);if(e.success&&e.data){const a=this.indicators.findIndex(o=>o.id===i);a!==-1&&(this.indicators[a]=e.data),this.currentIndicator=e.data}else throw this.error=e.error||"Failed to update indicator",new Error(this.error)}catch(r){throw this.error="An error occurred while updating indicator",console.error(r),r}finally{this.loading=!1}},async deleteIndicator(i){this.loading=!0,this.error=null;try{const{del:t}=s(),r=await t(`/indicators/${i}`);if(r.success)this.indicators=this.indicators.filter(e=>e.id!==i),this.currentIndicator?.id===i&&(this.currentIndicator=null);else throw this.error=r.error||"Failed to delete indicator",new Error(this.error)}catch(t){throw this.error="An error occurred while deleting indicator",console.error(t),t}finally{this.loading=!1}},async toggleActivation(i){this.loading=!0,this.error=null;try{const{post:t}=s(),r=await t(`/indicators/${i}/toggle-activation`,{});if(r.success&&r.data){const e=this.indicators.findIndex(a=>a.id===i);e!==-1&&(this.indicators[e]=r.data),this.currentIndicator?.id===i&&(this.currentIndicator=r.data)}else throw this.error=r.error||"Failed to toggle activation",new Error(this.error)}catch(t){throw this.error="An error occurred while toggling activation",console.error(t),t}finally{this.loading=!1}},async addIndicatorValue(i,t){this.loading=!0,this.error=null;try{const{post:r}=s(),e=await r(`/indicators/${i}/values`,t);if(e.success&&e.data)await this.fetchIndicatorById(i);else throw this.error=e.error||"Failed to add indicator value",new Error(this.error)}catch(r){throw this.error="An error occurred while adding indicator value",console.error(r),r}finally{this.loading=!1}},async updateIndicatorValue(i,t,r){this.loading=!0,this.error=null;try{const{put:e}=s(),a=await e(`/indicator-values/${t}`,r);if(a.success&&a.data)await this.fetchIndicatorById(i);else throw this.error=a.error||"Failed to update indicator value",new Error(this.error)}catch(e){throw this.error="An error occurred while updating indicator value",console.error(e),e}finally{this.loading=!1}},async deleteIndicatorValue(i,t){this.loading=!0,this.error=null;try{const{del:r}=s(),e=await r(`/indicator-values/${t}`);if(e.success)await this.fetchIndicatorById(i);else throw this.error=e.error||"Failed to delete indicator value",new Error(this.error)}catch(r){throw this.error="An error occurred while deleting indicator value",console.error(r),r}finally{this.loading=!1}}}});export{u};
