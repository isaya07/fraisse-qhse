import{D as u,E as o}from"./index-oOuEsLBu.js";const p=u("equipment",{state:()=>({categories:[],equipmentList:[],currentEquipment:null,maintenanceLogs:[],loading:!1,error:null}),getters:{getEquipmentById:e=>t=>e.equipmentList.find(s=>s.id===t),getEquipmentByCategory:e=>t=>e.equipmentList.filter(s=>s.category_id===t),getEquipmentByStatus:e=>t=>e.equipmentList.filter(s=>s.status===t)},actions:{async fetchCategories(){this.loading=!0;try{const{get:e}=o(),t=await e("/equipment-categories");if(t.success&&t.data){const s=t.data;this.categories=s.data||s}}catch(e){this.error="Failed to fetch categories",console.error(e)}finally{this.loading=!1}},async createCategory(e){this.loading=!0;try{const{post:t}=o(),s=await t("/equipment-categories",e);if(s.success&&s.data){const i=s.data,a=i.data||i;return this.categories.push(a),a}}catch(t){throw this.error="Failed to create category",t}finally{this.loading=!1}},async updateCategory(e,t){this.loading=!0;try{const{put:s}=o(),i=await s(`/equipment-categories/${e}`,t);if(i.success&&i.data){const a=i.data,n=a.data||a,r=this.categories.findIndex(c=>c.id===e);return r!==-1&&(this.categories[r]=n),n}}catch(s){throw this.error="Failed to update category",s}finally{this.loading=!1}},async deleteCategory(e){this.loading=!0;try{const{del:t}=o();(await t(`/equipment-categories/${e}`)).success&&(this.categories=this.categories.filter(i=>i.id!==e))}catch(t){throw this.error="Failed to delete category",t}finally{this.loading=!1}},async fetchEquipment(e){this.loading=!0;try{const{get:t}=o();let s="/equipment";if(e){const a=new URLSearchParams;Object.keys(e).forEach(r=>{e[r]&&a.append(r,e[r])});const n=a.toString();n&&(s+=`?${n}`)}const i=await t(s);if(i.success&&i.data){const a=i.data;this.equipmentList=a.data||a}}catch(t){this.error="Failed to fetch equipment",console.error(t)}finally{this.loading=!1}},async fetchEquipmentDetail(e){this.loading=!0;try{const{get:t}=o(),s=await t(`/equipment/${e}`);if(s.success&&s.data){const i=s.data;return this.currentEquipment=i.data||i,this.currentEquipment}}catch(t){this.error="Failed to fetch equipment detail",console.error(t)}finally{this.loading=!1}},async createEquipment(e){this.loading=!0;try{const{post:t}=o(),s=await t("/equipment",e);if(s.success&&s.data){const i=s.data,a=i.data||i;return this.equipmentList.push(a),a}}catch(t){throw this.error="Failed to create equipment",t}finally{this.loading=!1}},async updateEquipment(e,t){this.loading=!0;try{const{put:s}=o(),i=await s(`/equipment/${e}`,t);if(i.success&&i.data){const a=i.data,n=a.data||a,r=this.equipmentList.findIndex(c=>c.id===e);return r!==-1&&(this.equipmentList[r]=n),this.currentEquipment&&this.currentEquipment.id===e&&(this.currentEquipment=n),n}}catch(s){throw this.error="Failed to update equipment",s}finally{this.loading=!1}},async deleteEquipment(e){this.loading=!0;try{const{del:t}=o();(await t(`/equipment/${e}`)).success&&(this.equipmentList=this.equipmentList.filter(i=>i.id!==e))}catch(t){throw this.error="Failed to delete equipment",t}finally{this.loading=!1}},async assignEquipment(e,t){this.loading=!0;try{const{post:s}=o(),i=await s(`/equipment/${e}/assign`,t);if(i.success&&i.data){const a=i.data,n=a.data||a,r=this.equipmentList.findIndex(c=>c.id===e);return r!==-1&&(this.equipmentList[r]=n),this.currentEquipment&&this.currentEquipment.id===e&&(this.currentEquipment=n),n}}catch(s){throw this.error="Failed to assign equipment",s}finally{this.loading=!1}},async returnEquipment(e,t){this.loading=!0;try{const{post:s}=o(),i=await s(`/equipment/${e}/return`,t);if(i.success&&i.data){const a=i.data,n=a.data||a,r=this.equipmentList.findIndex(c=>c.id===e);return r!==-1&&(this.equipmentList[r]=n),this.currentEquipment&&this.currentEquipment.id===e&&(this.currentEquipment=n),n}}catch(s){throw this.error="Failed to return equipment",s}finally{this.loading=!1}},async fetchMaintenanceLogs(e){this.loading=!0;try{const{get:t}=o();let s="/maintenance-logs";e&&(s+=`?equipment_id=${e}`);const i=await t(s);if(i.success&&i.data){const a=i.data;this.maintenanceLogs=a.data||a}}catch(t){this.error="Failed to fetch maintenance logs",console.error(t)}finally{this.loading=!1}},async createMaintenanceLog(e){this.loading=!0;try{const{post:t}=o(),s=await t("/maintenance-logs",e);if(s.success&&s.data){const i=s.data,a=i.data||i;return this.maintenanceLogs.unshift(a),e.equipment_id&&await this.fetchEquipmentDetail(e.equipment_id),a}}catch(t){throw this.error="Failed to create maintenance log",t}finally{this.loading=!1}}}});export{p as u};
