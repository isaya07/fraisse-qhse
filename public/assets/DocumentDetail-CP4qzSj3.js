import{B as ce,c as g,o as n,z as ue,A as de,C as ve,D as pe,h as T,E as H,d as Q,g as se,i as R,j as te,m as D,w as a,a as e,b as t,u as r,r as W,t as u,p as b,l as J,s as C,k as oe,_ as me,q as fe,e as X,v as P,G as ye,f as ge,H as he,F as Y,x as _e,I as xe,y as be}from"./index-oOuEsLBu.js";import{u as we}from"./documents-BDxgjJlF.js";import{s as O}from"./index-CO5Pw-j-.js";import{s as M}from"./index-B3ik4ugR.js";import{T as $e}from"./index-C9vCuLi4.js";import{s as ke,a as U,b as Z}from"./index-obDBiGqA.js";import{s as ee}from"./index-CPM8aTbb.js";import{s as Ve}from"./index-DHPOKPzk.js";import{s as Ce}from"./index-D25kfrV8.js";import"./index-DXuF__Dl.js";import"./index-CFLhIysZ.js";import"./index-B0RCps1L.js";import"./index-kYhIjE44.js";import"./index-IzGGsCUm.js";import"./index-D4NNOuL2.js";import"./index-D2qS9a38.js";import"./index-C1JXx-aU.js";import"./index-Bsb9bHmP.js";import"./index-DGkmfP6q.js";import"./index-DsZb2wqs.js";var De=`
    .p-buttongroup {
        display: inline-flex;
    }

    .p-buttongroup .p-button {
        margin: 0;
    }

    .p-buttongroup .p-button:not(:last-child),
    .p-buttongroup .p-button:not(:last-child):hover {
        border-inline-end: 0 none;
    }

    .p-buttongroup .p-button:not(:first-of-type):not(:last-of-type) {
        border-radius: 0;
    }

    .p-buttongroup .p-button:first-of-type:not(:only-of-type) {
        border-start-end-radius: 0;
        border-end-end-radius: 0;
    }

    .p-buttongroup .p-button:last-of-type:not(:only-of-type) {
        border-start-start-radius: 0;
        border-end-start-radius: 0;
    }

    .p-buttongroup .p-button:focus {
        position: relative;
        z-index: 1;
    }
`,je={root:"p-buttongroup p-component"},Se=ce.extend({name:"buttongroup",style:De,classes:je}),Be={name:"BaseButtonGroup",extends:ve,style:Se,provide:function(){return{$pcButtonGroup:this,$parentInstance:this}}},re={name:"ButtonGroup",extends:Be,inheritAttrs:!1};function Te(x,$,m,k,c,S){return n(),g("span",de({class:x.cx("root"),role:"group"},x.ptmi("root")),[ue(x.$slots,"default")],16)}re.render=Te;const ne=pe("documentVersions",()=>{const x=T([]),$=T(!1),m=T(null);return{versions:x,loading:$,error:m,fetchVersions:async(f,h=!1)=>{$.value=!0,m.value=null;try{const{get:v}=H(),_=await v(`/documents/${f}/versions${h?"?with_archived=true":""}`);_.success&&_.data?x.value=_.data:m.value=_.error||"Impossible de charger les versions"}catch(v){console.error("Error fetching versions:",v),m.value="Impossible de charger les versions"}finally{$.value=!1}},createVersion:async(f,h)=>{$.value=!0,m.value=null;try{const{post:v}=H(),s=await v(`/documents/${f}/versions`,h);if(s.success&&s.data)return x.value.unshift(s.data.version),s.data;throw m.value=s.error||"Impossible de créer la version",new Error(m.value)}catch(v){throw console.error("Error creating version:",v),m.value="Impossible de créer la version",v}finally{$.value=!1}},downloadVersion:async f=>{try{const{get:h}=H(),v=await h(`/versions/${f}/download`,{responseType:"blob"});if(v.success&&v.data){const s=window.URL.createObjectURL(v.data),_=document.createElement("a");_.href=s;const E=x.value.find(I=>I.id===f);_.download=E?.filename||"document",document.body.appendChild(_),_.click(),document.body.removeChild(_),window.URL.revokeObjectURL(s)}}catch(h){throw console.error("Error downloading version:",h),m.value="Impossible de télécharger la version",h}},restoreVersion:async f=>{$.value=!0,m.value=null;try{const{post:h}=H(),v=await h(`/versions/${f}/restore`,{});if(v.success&&v.data)return x.value.unshift(v.data.version),v.data;throw m.value=v.error||"Impossible de restaurer la version",new Error(m.value)}catch(h){throw console.error("Error restoring version:",h),m.value="Impossible de restaurer la version",h}finally{$.value=!1}}}}),Ie={class:"flex justify-between items-center mb-4"},Ae={class:"flex items-center gap-4"},Ee={class:"flex items-center gap-2"},ze={class:"flex justify-between items-center mb-2"},Fe={class:"flex items-center gap-2"},Le={class:"flex items-center gap-2"},Me={class:"flex items-center gap-2"},Re={key:0,class:"flex justify-center py-8"},Ue={key:1,class:"text-center py-8 text-red-500"},Ne={key:2,class:"text-center py-8 text-color-secondary"},qe={class:"flex items-center gap-2"},Ge={class:"text-color"},He={key:0,class:"flex items-center gap-2"},Pe={class:"text-color"},Oe={key:1,class:"text-color-secondary"},Ke={class:"max-w-md"},Je={class:"text-sm text-color line-clamp-2"},Qe={class:"text-sm text-color-secondary"},We={class:"flex gap-1"},Xe={key:0,class:"py-4"},Ye={class:"mb-4"},Ze={class:"ml-2 font-medium text-color"},es={class:"mb-4"},ss={class:"ml-2 font-medium text-color"},ts={class:"text-color whitespace-pre-wrap"},os=Q({__name:"DocumentVersionHistory",props:{documentId:{},currentVersion:{}},emits:["restore"],setup(x,{emit:$}){const m=x,k=$,c=ne(),S=se(),p=R(()=>c.versions),f=R(()=>c.loading),h=R(()=>c.error),v=T(!1),s=T(null),_=T(!1),E=()=>{c.fetchVersions(m.documentId,_.value)},I=w=>w.version===m.currentVersion,j=w=>new Date(w).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),i=w=>{if(w===0)return"0 B";const d=1024,B=["B","KB","MB","GB"],F=Math.floor(Math.log(w)/Math.log(d));return Math.round(w/Math.pow(d,F)*100)/100+" "+B[F]},L=w=>{s.value=w,v.value=!0},z=async w=>{try{await c.downloadVersion(w.id),S.add({severity:"success",summary:"Succès",detail:`Version ${w.version} téléchargée`,life:3e3})}catch{S.add({severity:"error",summary:"Erreur",detail:"Impossible de télécharger la version",life:3e3})}},K=w=>{k("restore",w)};return te(()=>{c.fetchVersions(m.documentId)}),(w,d)=>{const B=W("font-awesome-icon"),F=O,N=$e;return n(),D(F,null,{title:a(()=>[e("div",ze,[e("div",Fe,[t(B,{icon:"clock-rotate-left"}),d[6]||(d[6]=e("span",null,"Historique des versions",-1))]),e("div",Le,[e("div",Me,[t(r(ee),{modelValue:_.value,"onUpdate:modelValue":d[1]||(d[1]=y=>_.value=y),onChange:E,inputId:"showArchived"},null,8,["modelValue"]),d[7]||(d[7]=e("label",{for:"showArchived",class:"text-sm cursor-pointer"},"Afficher archives",-1))]),t(r(M),{value:`${p.value.length} version${p.value.length>1?"s":""}`,severity:"info"},null,8,["value"])])])]),content:a(()=>[f.value?(n(),g("div",Re,[t(B,{icon:"spinner",spin:"",size:"2x",class:"text-color-secondary"})])):h.value?(n(),g("div",Ue,[e("p",null,u(h.value),1)])):p.value.length===0?(n(),g("div",Ne,[t(B,{icon:"inbox",size:"3x",class:"mb-3"}),d[8]||(d[8]=e("p",null,"Aucune version enregistrée",-1))])):(n(),D(r(ke),{key:3,value:p.value,class:"p-datatable-sm",stripedRows:""},{default:a(()=>[t(r(U),{header:"Version",style:{width:"100px"}},{body:a(({data:y})=>[e("div",qe,[t(r(M),{value:y.version,severity:I(y)?"success":"secondary"},null,8,["value","severity"]),I(y)?(n(),D(r(M),{key:0,value:"Actuelle",severity:"success",size:"small"})):b("",!0)])]),_:1}),t(r(U),{header:"Date",style:{width:"150px"}},{body:a(({data:y})=>[e("span",Ge,u(j(y.created_at)),1)]),_:1}),t(r(U),{header:"Créateur",style:{width:"180px"}},{body:a(({data:y})=>[y.creator?(n(),g("div",He,[t(B,{icon:"user",class:"text-color-secondary"}),e("span",Pe,u(y.creator.first_name)+" "+u(y.creator.last_name),1)])):(n(),g("span",Oe,"-"))]),_:1}),t(r(U),{header:"Changelog"},{body:a(({data:y})=>[e("div",Ke,[e("p",Je,u(y.changelog),1)])]),_:1}),t(r(U),{header:"Taille",style:{width:"100px"}},{body:a(({data:y})=>[e("span",Qe,u(i(y.file_size)),1)]),_:1}),t(r(U),{header:"Actions",style:{width:"120px"}},{body:a(({data:y})=>[e("div",We,[J((n(),D(r(C),{text:"",rounded:"",severity:"secondary",size:"small",onClick:q=>L(y)},{icon:a(()=>[t(B,{icon:"info-circle"})]),_:1},8,["onClick"])),[[N,"Voir changelog",void 0,{top:!0}]]),J((n(),D(r(C),{text:"",rounded:"",severity:"info",size:"small",onClick:q=>z(y)},{icon:a(()=>[t(B,{icon:"download"})]),_:1},8,["onClick"])),[[N,"Télécharger",void 0,{top:!0}]]),I(y)?b("",!0):J((n(),D(r(C),{key:0,text:"",rounded:"",severity:"warning",size:"small",onClick:q=>K(y)},{icon:a(()=>[t(B,{icon:"clock-rotate-left"})]),_:1},8,["onClick"])),[[N,"Restaurer cette version",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value"])),t(r(oe),{visible:v.value,"onUpdate:visible":d[3]||(d[3]=y=>v.value=y),header:`Changelog - Version ${s.value?.version}`,modal:!0,style:{width:"600px"}},{footer:a(()=>[t(r(C),{label:"Fermer",text:"",onClick:d[2]||(d[2]=y=>v.value=!1)})]),default:a(()=>[s.value?(n(),g("div",Xe,[e("div",Ye,[d[9]||(d[9]=e("span",{class:"text-sm text-color-secondary"},"Date :",-1)),e("span",Ze,u(j(s.value.created_at)),1)]),e("div",es,[d[10]||(d[10]=e("span",{class:"text-sm text-color-secondary"},"Créateur :",-1)),e("span",ss,u(s.value.creator?.first_name)+" "+u(s.value.creator?.last_name),1)]),e("div",null,[d[11]||(d[11]=e("span",{class:"text-sm text-color-secondary block mb-2"},"Description des changements :",-1)),e("p",ts,u(s.value.changelog),1)])])):b("",!0)]),_:1},8,["visible","header"])]),default:a(()=>[e("div",Ie,[d[5]||(d[5]=e("h3",{class:"text-lg font-semibold"},"Historique des versions",-1)),e("div",Ae,[e("div",Ee,[t(r(ee),{modelValue:_.value,"onUpdate:modelValue":d[0]||(d[0]=y=>_.value=y),onChange:E,inputId:"showArchived"},null,8,["modelValue"]),d[4]||(d[4]=e("label",{for:"showArchived",class:"text-sm cursor-pointer"},"Afficher archives",-1))]),t(r(M),{value:`${p.value.length} version${p.value.length>1?"s":""}`,severity:"info"},null,8,["value"])])])]),_:1})}}}),rs=me(os,[["__scopeId","data-v-96c93efd"]]),ns={class:"flex flex-col gap-4 py-4"},ls={class:"bg-blue-50 border border-blue-200 rounded p-4"},as={class:"flex items-center gap-2 mb-2"},is={class:"text-sm text-blue-800"},cs={class:"field"},us={class:"flex gap-4"},ds={class:"flex items-center"},vs={class:"flex items-center"},ps={key:0,class:"text-red-500"},ms={class:"field"},fs={key:0,class:"text-color-secondary block mt-1"},ys={key:1,class:"text-red-500 block mt-1"},gs={class:"field"},hs={class:"text-color-secondary"},_s={key:0,class:"text-red-500 block"},xs=Q({__name:"UploadNewVersionDialog",props:{visible:{type:Boolean},currentVersion:{},loading:{type:Boolean,default:!1}},emits:["update:visible","upload"],setup(x,{emit:$}){const m=x,k=$,c=T({versionType:"minor",file:null,changelog:""}),S=T(""),p=T({}),f=R(()=>{if(!m.currentVersion)return"1.0";const j=m.currentVersion.split("."),i=parseInt(j[0]||"1"),L=parseInt(j[1]||"0");return c.value.versionType==="major"?`${i+1}.0`:`${i}.${L+1}`}),h=R(()=>c.value.file!==null&&c.value.changelog.length>=10&&c.value.versionType!==""),v=j=>{const i=j.files;i&&i.length>0&&(c.value.file=i[0],S.value=i[0].name,p.value.file="")},s=()=>(p.value={},c.value.file||(p.value.file="Le fichier est requis"),c.value.changelog.length<10&&(p.value.changelog="Le changelog doit contenir au moins 10 caractères"),c.value.versionType||(p.value.versionType="Le type de version est requis"),Object.keys(p.value).length===0),_=()=>{s()&&c.value.file&&k("upload",{file:c.value.file,changelog:c.value.changelog,versionType:c.value.versionType})},E=()=>{k("update:visible",!1),I()},I=()=>{c.value={versionType:"minor",file:null,changelog:""},S.value="",p.value={}};return fe(()=>m.visible,j=>{j||I()}),(j,i)=>{const L=W("font-awesome-icon");return n(),D(r(oe),{visible:x.visible,"onUpdate:visible":E,header:"Nouvelle version du document",modal:!0,style:{width:"600px"}},{footer:a(()=>[t(r(C),{label:"Annuler",text:"",severity:"secondary",onClick:E}),t(r(C),{label:"Créer la version",onClick:_,loading:x.loading,disabled:!h.value},{icon:a(()=>[t(L,{icon:"upload",class:"mr-2"})]),_:1},8,["loading","disabled"])]),default:a(()=>[e("div",ns,[e("div",ls,[e("div",as,[t(L,{icon:"info-circle",class:"text-blue-600"}),i[3]||(i[3]=e("span",{class:"font-semibold text-blue-900"},"Information de version",-1))]),e("div",is,[e("p",null,[i[4]||(i[4]=X("Version actuelle : ",-1)),e("strong",null,u(x.currentVersion),1)]),e("p",null,[i[5]||(i[5]=X("Nouvelle version : ",-1)),e("strong",null,u(f.value),1)])])]),e("div",cs,[i[8]||(i[8]=e("label",{class:"block text-sm font-medium mb-3 text-color-secondary"},"Type de version *",-1)),e("div",us,[e("div",ds,[t(r(Z),{modelValue:c.value.versionType,"onUpdate:modelValue":i[0]||(i[0]=z=>c.value.versionType=z),inputId:"minor",value:"minor",class:P({"p-invalid":p.value.versionType})},null,8,["modelValue","class"]),i[6]||(i[6]=e("label",{for:"minor",class:"ml-2 cursor-pointer"},[e("div",null,[e("span",{class:"font-medium"},"Mineure"),e("p",{class:"text-xs text-color-secondary"},"Corrections, mises à jour mineures")])],-1))]),e("div",vs,[t(r(Z),{modelValue:c.value.versionType,"onUpdate:modelValue":i[1]||(i[1]=z=>c.value.versionType=z),inputId:"major",value:"major",class:P({"p-invalid":p.value.versionType})},null,8,["modelValue","class"]),i[7]||(i[7]=e("label",{for:"major",class:"ml-2 cursor-pointer"},[e("div",null,[e("span",{class:"font-medium"},"Majeure"),e("p",{class:"text-xs text-color-secondary"},"Changements significatifs")])],-1))])]),p.value.versionType?(n(),g("small",ps,u(p.value.versionType),1)):b("",!0)]),e("div",ms,[i[9]||(i[9]=e("label",{for:"file",class:"block text-sm font-medium mb-2 text-color-secondary"},"Nouveau fichier *",-1)),t(r(Ve),{mode:"basic",auto:!1,chooseLabel:"Choisir un fichier",onSelect:v,maxFileSize:10485760,class:P({"p-invalid":p.value.file})},null,8,["class"]),S.value?(n(),g("small",fs," Fichier sélectionné : "+u(S.value),1)):b("",!0),p.value.file?(n(),g("small",ys,u(p.value.file),1)):b("",!0)]),e("div",gs,[i[10]||(i[10]=e("label",{for:"changelog",class:"block text-sm font-medium mb-2 text-color-secondary"},"Description des changements *",-1)),t(r(Ce),{id:"changelog",modelValue:c.value.changelog,"onUpdate:modelValue":i[2]||(i[2]=z=>c.value.changelog=z),rows:"5",placeholder:"Décrivez les modifications apportées dans cette version (minimum 10 caractères)...",class:P(["w-full",{"p-invalid":p.value.changelog}])},null,8,["modelValue","class"]),e("small",hs,u(c.value.changelog.length)+" / 10 caractères minimum",1),p.value.changelog?(n(),g("small",_s,u(p.value.changelog),1)):b("",!0)])])]),_:1},8,["visible"])}}}),bs={key:0,class:"p-4 flex flex-col"},ws={class:"flex flex-col md:flex-row md:items-center md:justify-between mb-2"},$s={class:"flex items-center gap-4"},ks={class:"mt-0!"},Vs={class:"flex gap-2"},Cs={class:"flex justify-end gap-2 mb-2"},Ds={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},js={class:"lg:col-span-2 flex flex-col gap-6"},Ss={class:"flex items-center gap-2 mb-2"},Bs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ts={key:1,class:"text-color-secondary"},Is={class:"font-medium text-color"},As={class:"font-medium text-color"},Es={class:"font-medium text-color"},zs={key:0},Fs={class:"font-medium text-color"},Ls={key:1},Ms={class:"font-medium text-color"},Rs={key:2},Us={class:"font-medium text-red-500"},Ns={key:0,class:"mt-4 pt-4 border-t border-surface-border"},qs={class:"text-color"},Gs={class:"flex flex-col gap-6"},Hs={class:"flex items-center gap-2 mb-2"},Ps={class:"flex flex-col gap-3 text-sm"},Os={class:"flex justify-between"},Ks=["title"],Js={class:"flex justify-between"},Qs={class:"text-color"},Ws={class:"flex justify-between"},Xs=["title"],Ys={class:"flex items-center gap-2 mb-2"},Zs={key:0,class:"flex flex-col gap-3"},et=["onClick"],st={class:"flex justify-between items-start mb-1"},tt={class:"font-medium text-color text-sm line-clamp-2"},ot={class:"flex justify-between items-center text-xs text-color-secondary"},rt={key:0},nt={key:1,class:"text-color-secondary text-sm italic"},lt={key:1,class:"flex justify-center py-12"},jt=Q({__name:"DocumentDetail",setup(x){const $=he(),m=be(),k=we(),c=ne(),S=ye(),p=ge(),f=se(),h=T(!1),v=T(!1),s=R(()=>k.currentDocument),_=()=>{m.back()},E=()=>{m.push(`/documents/${$.params.id}/edit`)},I=async()=>{if(s.value)try{f.add({severity:"info",summary:"Téléchargement",detail:"Le téléchargement a commencé...",life:3e3}),await k.downloadDocument(s.value.id,s.value.filename)}catch{f.add({severity:"error",summary:"Erreur",detail:"Erreur lors du téléchargement",life:3e3})}},j=()=>{p.require({message:"Voulez-vous vraiment supprimer ce document ?",header:"Confirmation",icon:"exclamation-triangle",acceptClass:"p-button-danger",rejectClass:"p-button-secondary",rejectLabel:"Annuler",acceptLabel:"Supprimer",accept:async()=>{try{s.value&&(await k.deleteDocument(s.value.id),f.add({severity:"success",summary:"Succès",detail:"Document supprimé",life:3e3}),m.push("/documents"))}catch{f.add({severity:"error",summary:"Erreur",detail:"Erreur lors de la suppression",life:3e3})}}})},i=()=>{h.value=!0},L=async l=>{if(s.value){v.value=!0;try{const o=new FormData;o.append("file",l.file),o.append("changelog",l.changelog),o.append("version_type",l.versionType),await c.createVersion(s.value.id,o),f.add({severity:"success",summary:"Succès",detail:"Nouvelle version créée avec succès",life:3e3}),h.value=!1,await k.fetchDocumentById(parseInt($.params.id)),await c.fetchVersions(s.value.id)}catch(o){console.error("Error uploading version:",o),f.add({severity:"error",summary:"Erreur",detail:"Impossible de créer la nouvelle version",life:3e3})}finally{v.value=!1}}},z=l=>{p.require({message:`Voulez-vous vraiment restaurer la version ${l.version} ? Cela créera une nouvelle version majeure basée sur ce fichier.`,header:"Confirmation de restauration",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-warning",acceptLabel:"Restaurer",rejectLabel:"Annuler",accept:async()=>{try{await c.restoreVersion(l.id),f.add({severity:"success",summary:"Succès",detail:"Version restaurée avec succès",life:3e3}),s.value&&await k.fetchDocumentById(s.value.id)}catch{f.add({severity:"error",summary:"Erreur",detail:"Impossible de restaurer la version",life:3e3})}}})},K=R(()=>["admin","manager"].includes(S.user?.role||"")),w=async()=>{if(s.value)try{await k.requestApproval(s.value.id),f.add({severity:"success",summary:"Succès",detail:"Demande d'approbation envoyée",life:3e3})}catch{f.add({severity:"error",summary:"Erreur",detail:"Erreur lors de la demande",life:3e3})}},d=async()=>{if(s.value)try{await k.approveDocument(s.value.id),f.add({severity:"success",summary:"Succès",detail:"Document approuvé",life:3e3})}catch{f.add({severity:"error",summary:"Erreur",detail:"Erreur lors de l'approbation",life:3e3})}},B=async()=>{if(s.value)try{await k.rejectDocument(s.value.id),f.add({severity:"success",summary:"Succès",detail:"Document rejeté",life:3e3})}catch{f.add({severity:"error",summary:"Erreur",detail:"Erreur lors du rejet",life:3e3})}},F=l=>l?new Date(l).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",N=l=>{if(l===void 0)return"-";if(l===0)return"0 B";const o=1024,V=["B","KB","MB","GB","TB"],G=Math.floor(Math.log(l)/Math.log(o));return parseFloat((l/Math.pow(o,G)).toFixed(2))+" "+V[G]},y=l=>{if(!l)return"file";switch(l.split(".").pop()?.toLowerCase()){case"pdf":return"file-pdf";case"doc":case"docx":return"file-word";case"xls":case"xlsx":return"file-excel";case"jpg":case"png":case"jpeg":return"image";default:return"file"}},q=l=>l?{draft:"Brouillon",pending_approval:"En attente",approved:"Approuvé",rejected:"Rejeté",archived:"Archivé"}[l]||l:"-",le=l=>l&&{draft:"secondary",pending_approval:"warn",approved:"success",rejected:"danger",archived:"contrast"}[l]||"secondary",ae=l=>l?{low:"Basse",medium:"Moyenne",high:"Haute",critical:"Critique"}[l]||l:"-",ie=l=>l?{low:"info",medium:"warn",high:"danger",critical:"danger"}[l]||"info":"secondary";return te(async()=>{const l=parseInt($.params.id);l&&await k.fetchDocumentById(l)}),(l,o)=>{const V=W("font-awesome-icon"),G=re;return n(),g(Y,null,[s.value?(n(),g("div",bs,[e("div",ws,[e("div",$s,[t(r(C),{text:"",rounded:"",severity:"secondary",onClick:_},{icon:a(()=>[t(V,{icon:"arrow-left"})]),_:1}),e("h2",ks,u(s.value.title),1),t(r(M),{value:q(s.value.status),severity:le(s.value.status)},null,8,["value","severity"])]),e("div",Vs,[t(G,null,{default:a(()=>[s.value.status==="approved"?(n(),D(r(C),{key:0,label:"Nouvelle version",severity:"info",onClick:i},{icon:a(()=>[t(V,{icon:"upload"})]),_:1})):b("",!0),t(r(C),{label:"Télécharger",severity:"primary",onClick:I},{icon:a(()=>[t(V,{icon:"download"})]),_:1}),t(r(C),{label:"Modifier",severity:"success",onClick:E},{icon:a(()=>[t(V,{icon:"pencil"})]),_:1}),t(r(C),{label:"Supprimer",severity:"danger",onClick:j},{icon:a(()=>[t(V,{icon:"trash"})]),_:1})]),_:1})])]),e("div",Cs,[s.value.status==="draft"||s.value.status==="rejected"?(n(),D(r(C),{key:0,label:"Demander approbation",severity:"help",onClick:w},{icon:a(()=>[t(V,{icon:"paper-plane"})]),_:1})):b("",!0),s.value.status==="pending_approval"&&K.value?(n(),D(G,{key:1},{default:a(()=>[t(r(C),{label:"Rejeter",severity:"danger",outlined:"",onClick:B},{icon:a(()=>[t(V,{icon:"times"})]),_:1}),t(r(C),{label:"Approuver",severity:"success",onClick:d},{icon:a(()=>[t(V,{icon:"check"})]),_:1})]),_:1})):b("",!0)]),e("div",Ds,[e("div",js,[t(r(O),null,{title:a(()=>[e("div",Ss,[t(V,{icon:"info-circle"}),o[1]||(o[1]=e("span",null,"Informations Générales",-1))])]),content:a(()=>[e("div",Bs,[e("div",null,[o[2]||(o[2]=e("span",{class:"block text-sm text-color-secondary font-bold"},"Type : ",-1)),s.value.category?(n(),D(r(M),{key:0,value:s.value.category.name,style:_e({backgroundColor:s.value.category.color||"var(--surface-500)",color:"#fff"})},{icon:a(()=>[s.value.category.icon?(n(),D(V,{key:0,icon:["fas",s.value.category.icon],class:"mr-1"},null,8,["icon"])):b("",!0)]),_:1},8,["value","style"])):(n(),g("span",Ts,"Non défini"))]),e("div",null,[o[3]||(o[3]=e("span",{class:"block text-sm text-color-secondary font-bold"},"Version : ",-1)),e("span",Is,u(s.value.version),1)]),e("div",null,[o[4]||(o[4]=e("span",{class:"block text-sm text-color-secondary font-bold"},"Créé par : ",-1)),e("span",As,u(s.value.creator?.first_name)+" "+u(s.value.creator?.last_name),1)]),e("div",null,[o[5]||(o[5]=e("span",{class:"block text-sm text-color-secondary font-bold"},"Date de création : ",-1)),e("span",Es,u(F(s.value.created_at)),1)]),s.value.approver?(n(),g("div",zs,[o[6]||(o[6]=e("span",{class:"block text-sm text-color-secondary font-bold"},"Approuvé par : ",-1)),e("span",Fs,u(s.value.approver?.first_name)+" "+u(s.value.approver?.last_name),1)])):b("",!0),s.value.published_date?(n(),g("div",Ls,[o[7]||(o[7]=e("span",{class:"block text-sm text-color-secondary font-bold"},"Date de publication",-1)),e("span",Ms,u(F(s.value.published_date)),1)])):b("",!0),s.value.expires_date?(n(),g("div",Rs,[o[8]||(o[8]=e("span",{class:"block text-sm text-color-secondary font-bold"},"Date d'expiration : ",-1)),e("span",Us,u(F(s.value.expires_date)),1)])):b("",!0)]),s.value.description?(n(),g("div",Ns,[o[9]||(o[9]=e("span",{class:"block text-sm text-color-secondary font-bold mb-1"},"Description : ",-1)),e("p",qs,u(s.value.description),1)])):b("",!0)]),_:1}),s.value?(n(),D(rs,{key:0,"document-id":s.value.id,"current-version":s.value.version,onRestore:z},null,8,["document-id","current-version"])):b("",!0)]),e("div",Gs,[t(r(O),null,{title:a(()=>[e("div",Hs,[t(V,{icon:"file"}),o[10]||(o[10]=e("span",null,"Fichier",-1))])]),content:a(()=>[e("div",Ps,[e("div",Os,[o[11]||(o[11]=e("span",{class:"text-color-secondary font-bold"},"Nom : ",-1)),e("span",{class:"text-color truncate",title:s.value.filename},u(s.value.filename),9,Ks)]),e("div",Js,[o[12]||(o[12]=e("span",{class:"text-color-secondary font-bold"},"Taille : ",-1)),e("span",Qs,u(N(s.value.file_size)),1)]),e("div",Ws,[o[13]||(o[13]=e("span",{class:"text-color-secondary font-bold"},"Type MIME : ",-1)),e("span",{class:"text-color truncate",title:s.value.mime_type},u(s.value.mime_type||"-"),9,Xs),t(V,{icon:y(s.value.filename)},null,8,["icon"])])])]),_:1}),t(r(O),null,{title:a(()=>[e("div",Ys,[t(V,{icon:"tasks"}),o[14]||(o[14]=e("span",null,"Actions Liées",-1))])]),content:a(()=>[s.value.actions&&s.value.actions.length>0?(n(),g("div",Zs,[(n(!0),g(Y,null,xe(s.value.actions,A=>(n(),g("div",{key:A.id,class:"p-3 border rounded-lg hover:bg-surface-50 cursor-pointer transition-colors",onClick:at=>r(m).push(`/actions/${A.id}`)},[e("div",st,[e("span",tt,u(A.title),1),t(r(M),{severity:ie(A.priority),class:"text-xs",value:ae(A.priority).charAt(0)},null,8,["severity","value"])]),e("div",ot,[e("span",null,u(q(A.status)),1),A.due_date?(n(),g("span",rt,u(F(A.due_date)),1)):b("",!0)])],8,et))),128))])):(n(),g("div",nt,"Aucune action liée."))]),_:1})])])])):(n(),g("div",lt,[t(V,{icon:["fas","spinner"],spin:"",size:"2x",class:"text-gray-500"})])),s.value?(n(),D(xs,{key:2,visible:h.value,"onUpdate:visible":o[0]||(o[0]=A=>h.value=A),"current-version":s.value.version,loading:v.value,onUpload:L},null,8,["visible","current-version","loading"])):b("",!0)],64)}}});export{jt as default};
